@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using BaseSolution.BlazorServer.Components.SignUp;
@using BaseSolution.BlazorServer.Components.ForgotPassword;
@inject IDialogService DialogService
@inject ISnackbar _snackbar
<MudDialog Style="width:50%">
    <DialogContent>
            <MudTabs Elevation="4" Rounded="true" Centered="true">
    <MudTabPanel Text="Đăng nhập"/>
    <MudTabPanel @onclick="OpenDialog" Variant="Variant.Filled" Text="Đăng ký"/>
</MudTabs>
            <MudForm >
            <MudTextField   T="string" Label="Tài khoản"/>
            <MudTextField T="string" Label="Mật khẩu" AdornmentIcon="@PasswordInputIcon"/>
            <MudGrid Class="mt-3">
                    <MudItem xs="8">
                        <MudText @onclick="OpenDialogg" Variant="Variant.Filled" Color="Color.Warning"> Quên mật khẩu ? </MudText>
                    </MudItem>
              @*      <MudItem xs="6">
                        
                </MudItem>*@
                    <MudItem xs="4">
               @* <MudButton @onclick="OpenDialog" Variant="Variant.Filled" Color="Color.Secondary"> Đăng Ký </MudButton>*@
                </MudItem>
                </MudGrid>
            </MudForm>   
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Error" OnClick="Cancel">Hủy</MudButton>
        <MudButton Color="Color.Success" OnClick="OnButtonClicked">Đăng nhập</MudButton>
    </DialogActions>
</MudDialog>
@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    InputType PasswordInput = InputType.Password;
    string PasswordInputIcon = Icons.Material.Filled.VisibilityOff;

    void Submit() => MudDialog.Close(DialogResult.Ok(true));
    void Cancel() => MudDialog.Cancel();
    private void OpenDialog()
    {
        DialogOptions closeOnEscapeKey = new DialogOptions() { CloseOnEscapeKey = true };

        DialogService.Show<SignUp>("Đăng ký", closeOnEscapeKey);
    }
    private void OpenDialogg()
    {
        DialogOptions closeOnEscapeKey = new DialogOptions() { CloseOnEscapeKey = true };

        DialogService.Show<ForgotPassword>("Quên mật khẩu", closeOnEscapeKey);
    }
    [Inject] private IDialogService _dialogService { get; set; } = null!;
    private async void OnButtonClicked()
    {
        bool? result = await _dialogService.ShowMessageBox(
     "Xác nhận",
     "Bạn có chắc muốn đăng nhập?",
     yesText: "Xác nhận", cancelText: "Hủy");
        if (result == true)
        {
            _snackbar.Add("Đăng nhập thành công!", Severity.Success);
            await Task.Delay(60);
            MudDialog.Close(DialogResult.Ok(true));
            StateHasChanged();
        }
        else
        {
            _snackbar.Add("Đăng nhập thất bại!", Severity.Error);
        }
    }
}
