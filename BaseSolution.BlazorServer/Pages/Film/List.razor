@page "/listfilm"
@using BaseSolution.BlazorServer.Components.Film;
@using BaseSolution.Domain.Entities;
@inject IDialogService DialogService
<MudGrid>
 <MudItem xs="8">
        <MudText  Class="mt-3" Typo="Typo.h4">Danh sách Phim</MudText>
    </MudItem>
    <MudItem xs="4">
        <MudTextField  @bind-Value="Search" Label="Tìm kiếm"   Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Search" AdornmentColor="Color.Secondary" />
    </MudItem>
 </MudGrid>
<MudButton @onclick="OpenDialog" Variant="Variant.Filled" Color="Color.Success" Class="mt-3"><MudIcon Icon="@Icons.Material.Filled.AddCircleOutline"></MudIcon>Thêm mới</MudButton>
    <MudTable Items="@lst" Class="mt-4">
         <HeaderContent>
        <MudTh>STT</MudTh>
        <MudTh>Mã Phim</MudTh>
        <MudTh>Tên Phim</MudTh>
        <MudTh>Đạo diễn</MudTh>
         <MudTh>Ngôn Ngữ</MudTh>
         <MudTh>Thể loại</MudTh>
        <MudTh>Thời Lượng</MudTh>
        <MudTh>Độ tuổi</MudTh>
        <MudTh>Chức năng</MudTh>
    </HeaderContent>
    <RowTemplate>
            <MudTd DataLabel="Stt">@(lst.IndexOf(context) + 1)</MudTd>
                    <MudTd DataLabel="Mã Phim">@context.Code</MudTd>
                        <MudTd DataLabel="Tên Phim">@context.Title</MudTd>
                          <MudTd DataLabel="Đạo diễn">@context.DirectedBy</MudTd>
                              <MudTd DataLabel="Ngôn Ngữ">@context.Language</MudTd>
                              <MudTd DataLabel="Thể loại">@context.Genres</MudTd>
                        <MudTd DataLabel="Thời lượng">@context.Duration</MudTd>
                            <MudTd DataLabel="Xếp hạng tuổi">@context.AgeRating</MudTd>
                    <MudTd>
        <MudIconButton @onclick="OpenDialogg" Variant="Variant.Filled" Color="Color.Warning"Icon="@Icons.Material.Filled.BorderColor"></MudIconButton>
                    <MudIconButton @onclick="DeleteUser" Variant="Variant.Filled" Color="Color.Error" Icon="@Icons.Material.Filled.Delete" aria-label="delete"></MudIconButton>
                </MudTd>
            </RowTemplate>
                 <PagerContent>
                    <MudTablePager />
                </PagerContent>
    </MudTable>
    @code {
    public string Search { get; set; }
    List<FilmEntity> lst = new List<FilmEntity>()
{
        new FilmEntity() { Code = "F001", Title = "Cuộc đời của Mun" , DirectedBy = "Trịnh Duy Long", Language = "Tiếng Việt", Genres = "Tâm lý tình cảm" , Duration = "150 phút", AgeRating = "12+"}    
};
    private void OpenDialog()
    {
        DialogOptions closeOnEscapeKey = new DialogOptions() { CloseOnEscapeKey = true };
        DialogService.Show<Create>("Thêm Mới Phim", closeOnEscapeKey);
    }
    private void OpenDialogg()
    {
        DialogOptions closeOnEscapeKey = new DialogOptions() { CloseOnEscapeKey = true };
        DialogService.Show<Update>("Sửa Thông Tin Phim", closeOnEscapeKey);
    }
    private void DeleteUser()
    {
        var parameters = new DialogParameters<Delete>();
        parameters.Add(x => x.ContentText, "bạn có chắc chắn muốn xóa không ?");
        parameters.Add(x => x.ButtonText, "Xóa");
        parameters.Add(x => x.Color, Color.Error);
        var options = new DialogOptions() { CloseButton = true, MaxWidth = MaxWidth.ExtraSmall };
        DialogService.Show<Delete>("Xóa Phim", parameters, options);
    }
}